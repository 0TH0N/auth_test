# **Данный проект является выполненным тестовым заданием.**

### **Задача:**

>**Необходимо написать сервис авторизации, используя фреймворк Symfony 4.4.
>Логика работы сервиса должна быть следующей:**
>
>- К сервису авторизации поступает запрос на авторизацию пользователя в виде jsona (Обязательные поля - логин, пароль, время запроса. В случае необходимости, разрешается добавлять свои поля);
>- Сервис получает объект и верифицирует его. Проверяет наличие пользователя в БД. В случае успеха - отдает ключ авторизации;
>- В случае неудачи, сервис выдает соответствующее сообщение.
>- Обязательно коммитить все изменения
>
>**Что хотелось бы увидеть в реализации:**
>
>- Валидацию входящего json;
>- Сериализацию / Валидацию входящего объекта;
>- Четкую и понятную архитектуру сервиса, лучше будет если разбить логику по слоям;
>- Юнит-тесты;
>- Описание твоих классов в phpdoc;
>- Exceptions;
>- Готовый проект на github/bitbucket.
>
>**Дополнительно (не обязательно к выполнению):**>
>
>- Использование архитектурных паттернов;
>- Минимум собственных наработок, максимум готовых инструментов;
>- Будет здорово, если будет упаковано приложение в docker-compose, для удобства тестирования.

### **Порядок развертывания проекта локально для тестирования:**
1. Клонировать проект с github.
>git clone https://github.com/0TH0N/auth_test.git
2. Перейти в папку проекта.
>cd auth_test/
3. Запустить проект с помощью docker-compose.
>docker-compose up -d
4. Войти в контейнер запущенного приложения.
>docker exec -it app bash
5. Запустить скачивание и установку пакетов PHP с Composer.
>make install
6. Загрузить тестовые фикстуры в базу данных.
>make fixtures
7. Запустить тесты.
>make test

Также в проекте есть файл "test.http" от встроенного в PHPSTORM HTTP клиента.
С помощью него можно вручную сделать некоторые запросы и видеть ответы приложения.

Адрес приложения: http://mysite.loc/

Адрес PHPMyAdmin: http://localhost:8081/

Адрес сервера: db

Логин: symfony

Пароль: symfony

### **Краткое заключение:**

Затраченное на проект фактическое время оцениваю в плюс-минус 15 часов.

Больше всего времени затратил на:

1. Разделение способов аутентификации в зависимости от роута. 
   По пути "/api/user/token" аутентификация идет с помощью передачи 
   пары "логин-пароль" в теле JSON. По остальным роутам "/api/*" 
   аутентификация идет с помощью передачи токена в заголовке "X-AUTH-TOKEN". 
   Так как работал до этого только на существующих проектах пришлось немного 
   покопаться в документации для нахождения правильной реализации.
   
2. Проблемы с передачей ответа от PHP-FPM к NGINX с текстом ошибки
   "Nginx Upstream sent too big header". Не DevOps, поэтому затратил 
   на гуглеж, понимание сути проблемы и её решение некоторое время. 
   По-хорошему надо точно разобраться в этой проблеме, так как непонятно 
   насколько это вызывать будет проблемы под нагрузкой на проде. Так как 
   задание тестовое с этим вопросом не заморачивался.
   
3. Первоначальная настройка докера для проекта. Опять же, не делал проекты 
с нуля (за исключением редких учебных), поэтому повозился с этим. Исходный 
   код Symfony проекта поместил в папку "project" так как обнаружил, что 
   "Symfony Flex" отказывается развертывать каркас приложения в непустую
   папку. Не стал заморачиваться и создал папку "project".
   
В целом, не заморачивался насчет некоторых мелочей, которые были бы актуальны 
для проекта предназначенного для продакшен эксплуатации, так как цель у 
данного приложения в демонстрации других моих практических навыков.

### **P.S. Надеюсь на вашу обратную связь.**